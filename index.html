<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<body>
	<canvas id="mycanvas"></canvas>
	<script>
		const canvas = document.querySelector("#mycanvas");
		const gl = canvas.getContext('webgl') ||
			canvas.getContext('experimental-webgl');
		if (!gl) throw new Error('browser may not support webgl');

		gl.clearColor(0.0, 0.0, 0.0, 1.0);
		gl.clear(gl.COLOR_BUFFER_BIT);

		const vertex_shader_src = `			\
			attribute vec4 aPosition;		\
			attribute float aPointSize;		\
			attribute vec4 aColor;			\
			varying vec4 vColor;			\
			void main() {					\
				gl_Position = aPosition;	\
				gl_PointSize = aPointSize;	\
				vColor = aColor;			\
			}								\
		`;

		const fragment_shader_src = `		\
			precision mediump float;		\
			varying vec4 vColor;			\
			void main() {					\
				gl_FragColor = vColor;		\
			}								\
		`;

		function compile(gl, type, shaderSrc) {
			const shader = gl.createShader(type);
			gl.shaderSource(shader, shaderSrc);
			gl.compileShader(shader);

			if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
				throw new Error(gl.getShaderInfoLog(shader));
			}

			return shader;
		}

		function link(gl, vertex_shader, fragment_shader) {
			const program = gl.createProgram();
			gl.attachShader(program, vertex_shader);
			gl.attachShader(program, fragment_shader);
			gl.linkProgram(program);

			if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
				throw new Error(gl.getShaderInfoLog(program));
			}

			return program;
		}
		const program = link(
				gl,
				compile(gl, gl.VERTEX_SHADER, vertex_shader_src),
				compile(gl, gl.FRAGMENT_SHADER, fragment_shader_src)
			);

		gl.useProgram(program);

		const aPosition = gl.getAttribLocation(program, 'aPosition');
		const uFragColor = gl.getUniformLocation(program, 'uFragColor');

		gl.vertexAttrib2f(aPosition, 0.0, 0.0);
		gl.uniform4f(uFragColor, 1.0, 0.0, 0.0, 1.0);

		gl.drawArrays(gl.POINTS, 0, 1); // minimize draw calls, they are expensive

	</script>
</body>
</html>